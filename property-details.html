<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Details - VeRandA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="nav-footer.css">
    <link rel="stylesheet" href="property-details.css">

    <style>
       /* ========== PROPERTY DETAILS STYLES ========== */
.property-details-container {
    max-width: 1200px;
    margin: 100px auto 50px;
    padding: 0 20px;
}

/* معرض الصور */
.property-gallery {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 10px;
    margin-bottom: 40px;
    height: 500px;
    border-radius: 15px;
    overflow: hidden;
}

.main-image {
    position: relative;
    border-radius: 15px;
    overflow: hidden;
}

.main-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.thumbnail-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 10px;
}

.thumbnail {
    border-radius: 10px;
    overflow: hidden;
    cursor: pointer;
    height: calc(33.333% - 7px);
    position: relative;
}

.thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s;
}

.thumbnail:hover img {
    transform: scale(1.05);
}

/* المعلومات الرئيسية */
.property-info {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 40px;
    margin-bottom: 50px;
}

.property-main-info h1 {
    font-size: 2.5rem;
    color: #2c3e50;
    margin-bottom: 15px;
}

.property-location {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #7f8c8d;
    margin-bottom: 20px;
}

.property-location i {
    color: #e74c3c;
}

.property-price-large {
    font-size: 2rem;
    color: #2c3e50;
    font-weight: bold;
    margin-bottom: 30px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 12px;
    text-align: center;
}

.property-features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
    padding: 25px;
    background: #f8f9fa;
    border-radius: 12px;
}

.feature-item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 1.1rem;
}

.feature-item i {
    color: #3498db;
    font-size: 1.3rem;
    width: 30px;
}

/* الـ Sidebar (الحجز والتقويم) */
.property-sidebar {
    background: white;
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    height: fit-content;
    position: sticky;
    top: 100px;
}

.booking-widget {
    text-align: center;
}

.calendar-container {
    margin-bottom: 25px;
}

.calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.calendar-header h3 {
    color: #2c3e50;
    font-size: 1.3rem;
}

.calendar-nav {
    display: flex;
    gap: 10px;
}

.calendar-nav button {
    background: #3498db;
    color: white;
    border: none;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 0.9rem;
}

.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 5px;
    margin-bottom: 15px;
}

.calendar-day-header {
    text-align: center;
    font-weight: 600;
    color: #7f8c8d;
    font-size: 0.9rem;
    padding: 8px 0;
}

.calendar-day {
    text-align: center;
    padding: 10px 0;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    font-weight: 500;
}

.calendar-day.available {
    background: white;
    color: #2c3e50;
}

.calendar-day.available:hover {
    background: #3498db;
    color: white;
}

.calendar-day.booked {
    background: #e74c3c;
    color: white;
    cursor: not-allowed;
}

.calendar-day.empty {
    background: transparent;
    cursor: default;
}

.calendar-day.today {
    background: #3498db;
    color: white;
}

.booking-summary {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
    text-align: left;
}

.booking-detail {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    font-size: 1rem;
}

.booking-detail.total {
    font-weight: bold;
    font-size: 1.2rem;
    border-top: 1px solid #ddd;
    padding-top: 10px;
    margin-top: 10px;
}

.booking-btn {
    width: 100%;
    padding: 15px;
    background: linear-gradient(to right, #023E8A, #0077B6);
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    margin-bottom: 15px;
}

.booking-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(2, 62, 138, 0.3);
}

.favorite-btn-details {
    width: 100%;
    padding: 12px;
    background: white;
    color: #e74c3c;
    border: 2px solid #e74c3c;
    border-radius: 10px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.favorite-btn-details.active {
    background: #e74c3c;
    color: white;
}

.favorite-btn-details:hover {
    transform: translateY(-2px);
}

/* الأقسام الإضافية */
.details-section {
    margin-bottom: 40px;
}

.details-section h2 {
    color: #2c3e50;
    margin-bottom: 20px;
    font-size: 1.8rem;
    border-bottom: 2px solid #3498db;
    padding-bottom: 10px;
}

.description-text {
    line-height: 1.8;
    color: #555;
    font-size: 1.1rem;
    background: #f8f9fa;
    padding: 25px;
    border-radius: 12px;
    border-left: 4px solid #3498db;
}

.amenities-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
}

.amenity-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
    transition: transform 0.3s;
}

.amenity-item:hover {
    transform: translateX(5px);
    background: #e8f4fc;
}

.amenity-item i {
    color: #27ae60;
    width: 20px;
    font-size: 1.1rem;
}

/* التقييمات */
.rating-overview {
    display: flex;
    align-items: center;
    gap: 30px;
    margin-bottom: 30px;
    padding: 25px;
    background: #f8f9fa;
    border-radius: 12px;
}

.average-rating {
    text-align: center;
}

.rating-number {
    font-size: 3rem;
    font-weight: bold;
    color: #2c3e50;
}

.rating-stars {
    color: #f39c12;
    margin: 10px 0;
    font-size: 1.2rem;
}

.review-count {
    color: #7f8c8d;
    font-size: 1rem;
}

/* الخريطة */
.location-section {
    background: #f8f9fa;
    padding: 25px;
    border-radius: 12px;
}

.location-info {
    margin-bottom: 20px;
}

.location-info h3 {
    color: #2c3e50;
    margin-bottom: 10px;
    font-size: 1.3rem;
}

.location-address {
    color: #555;
    font-size: 1.1rem;
    line-height: 1.6;
}

.map-container {
    height: 300px;
    border-radius: 12px;
    overflow: hidden;
    margin-top: 20px;
    border: 2px solid #ddd;
}

/* تصميم متجاوب */
@media (max-width: 968px) {
    .property-info {
        grid-template-columns: 1fr;
        gap: 30px;
    }
    
    .property-gallery {
        grid-template-columns: 1fr;
        height: auto;
    }
    
    .thumbnail-grid {
        grid-template-columns: repeat(3, 1fr);
        height: 150px;
    }
    
    .property-sidebar {
        position: static;
    }
}

@media (max-width: 768px) {
    .property-details-container {
        margin-top: 80px;
    }
    
    .property-main-info h1 {
        font-size: 2rem;
    }
    
    .property-features {
        grid-template-columns: 1fr;
    }
    
    .amenities-grid {
        grid-template-columns: 1fr;
    }
    
    .rating-overview {
        flex-direction: column;
        text-align: center;
        gap: 20px;
    }
}
    </style>
</head>
<body>
    <!-- النافبار -->
    <div id="navbar"></div>

    <!-- قسم التفاصيل الرئيسي -->
    <div class="property-details-container" id="property-details">
        <!-- المحتوى سيتم تحميله بواسطة الجافاسكريبت -->
    </div>

    <!-- الفوتر -->
    <div id="footer"></div>

    <script src="main.js"></script>
    <script src="navbar.js"></script>
    <script src="property-details.js"></script>

    <script>
// بيانات العقارات
const properties = [
    {
        id: 1,
        title: "Luxury Rest House in Riyadh",
        type: "resthouse",
        images: [
            "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80",
            "https://images.unsplash.com/photo-1484154218962-a197022b5858?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1560185127-6ed189bf02f4?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1560185007-cde436f6a4d0?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80"
        ],
        description: "Elegant rest house in prime location with stunning views and modern interior design. Perfect for relaxing getaways and business trips.",
        rooms: 4,
        capacity: 6,
        rating: 4.5,
        reviews: 128,
        price: "2,264,000",
        pricePerNight: "1,200",
        location: "Al Olaya District, Riyadh",
        address: "King Fahd Road, Al Olaya, Riyadh 12221, Saudi Arabia",
        amenities: ["WiFi", "Swimming Pool", "Parking", "Gym", "Security", "Air Conditioning"],
        bookedDates: ["2024-01-15", "2024-01-16", "2024-01-20", "2024-01-21"]
    },
    {
        id: 2,
        title: "Premium Villa in Palm District",
        type: "villa",
        images: [
            "https://images.unsplash.com/photo-1613977257363-707ba9348227?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80",
            "https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1568605114967-8130f3a36994?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80"
        ],
        description: "Luxury villa with private garden and pool, elegant design and spacious areas. Perfect for large families and special occasions.",
        rooms: 6,
        capacity: 10,
        rating: 4.8,
        reviews: 76,
        price: "4,500,000",
        pricePerNight: "2,500",
        location: "Palm District, Jeddah",
        address: "Palm Street, Al Hamra District, Jeddah 23441, Saudi Arabia",
        amenities: ["Private Pool", "Garden", "Parking", "Gym", "Security", "Air Conditioning", "Maid Service"],
        bookedDates: ["2024-01-10", "2024-01-11", "2024-01-18", "2024-01-19"]
    },
    {
        id: 3,
        title: "Chalet with Panoramic View",
        type: "chalet",
        images: [
            "https://images.unsplash.com/photo-1513584684374-8bab748fbf90?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80",
            "https://images.unsplash.com/photo-1449824913935-59a10b8d2000?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1571896349842-33c89424de2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80"
        ],
        description: "Exclusive chalet with 360-degree mountain views. Perfect for romantic getaways and nature lovers seeking peace and tranquility.",
        rooms: 5,
        capacity: 8,
        rating: 4.9,
        reviews: 54,
        price: "6,200,000",
        pricePerNight: "3,200",
        location: "Mountain View, Abha",
        address: "Al Souda Road, Abha 62521, Saudi Arabia",
        amenities: ["Mountain View", "Fireplace", "Parking", "BBQ Area", "Security", "Air Conditioning", "Hot Tub"],
        bookedDates: ["2024-01-12", "2024-01-13", "2024-01-22", "2024-01-23"]
    },
    {
        id: 4,
        title: "Modern Rest House in Media District",
        type: "resthouse",
        images: [
            "https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80",
            "https://images.unsplash.com/photo-1493663284031-b7e3aefcae8e?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1554995207-c18c203602cb?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1484154218962-a197022b5858?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80"
        ],
        description: "Contemporary rest house with open design close to services and commercial centers. Ideal for business travelers and short stays.",
        rooms: 3,
        capacity: 4,
        rating: 4.2,
        reviews: 89,
        price: "1,800,000",
        pricePerNight: "800",
        location: "Media District, Riyadh",
        address: "Prince Turki bin Abdulaziz Road, Riyadh 12341, Saudi Arabia",
        amenities: ["WiFi", "Parking", "Security", "Air Conditioning", "Business Center", "Cleaning Service"],
        bookedDates: ["2024-01-14", "2024-01-15", "2024-01-24", "2024-01-25"]
    },
    {
        id: 5,
        title: "Modern Villa in Roses District",
        type: "villa",
        images: [
            "https://images.unsplash.com/photo-1570129477492-45c003edd2be?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80",
            "https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80"
        ],
        description: "Family villa in quiet neighborhood, modern design and spacious garden. Perfect for family gatherings and comfortable living.",
        rooms: 5,
        capacity: 8,
        rating: 4.6,
        reviews: 42,
        price: "3,750,000",
        pricePerNight: "1,800",
        location: "Roses District, Riyadh",
        address: "Al Urubah Road, Riyadh 13241, Saudi Arabia",
        amenities: ["Garden", "Parking", "Security", "Air Conditioning", "Playground", "Maid Service"],
        bookedDates: ["2024-01-16", "2024-01-17", "2024-01-26", "2024-01-27"]
    },
    {
        id: 6,
        title: "Luxury Chalet with Private Pool",
        type: "chalet",
        images: [
            "https://images.unsplash.com/photo-1540518614846-7eded102d7bf?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80",
            "https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1571896349842-33c89424de2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
            "https://images.unsplash.com/photo-1449824913935-59a10b8d2000?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80"
        ],
        description: "Elegant chalet with private rooftop pool and breathtaking mountain views. Ultimate luxury experience for special occasions.",
        rooms: 6,
        capacity: 10,
        rating: 4.7,
        reviews: 31,
        price: "7,500,000",
        pricePerNight: "4,000",
        location: "Al Souda Mountains, Abha",
        address: "Mountain Peak Road, Abha 62521, Saudi Arabia",
        amenities: ["Private Pool", "Mountain View", "Hot Tub", "Parking", "Security", "Fireplace", "BBQ Area"],
        bookedDates: ["2024-01-18", "2024-01-19", "2024-01-28", "2024-01-29"]
    }
];

// متغيرات التقويم
let currentMonth = new Date().getMonth();
let currentYear = new Date().getFullYear();

// دالة لتحميل تفاصيل العقار
function loadPropertyDetails() {
    const urlParams = new URLSearchParams(window.location.search);
    const propertyId = parseInt(urlParams.get('id'));
    
    const property = properties.find(p => p.id === propertyId);
    const container = document.getElementById('property-details');
    
    if (!property) {
        container.innerHTML = `
            <div class="error-message" style="text-align: center; padding: 100px 20px;">
                <h2>Property Not Found</h2>
                <p>The property you're looking for doesn't exist.</p>
                <a href="explore.html" style="color: #0077B6; text-decoration: none;">← Back to Properties</a>
            </div>
        `;
        return;
    }
    
    // توليد النجوم
    const stars = generateStars(property.rating);
    
    // التحقق من المفضلة
    const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
    const isFavorite = favorites.includes(property.id);
    
    // توليد معرض الصور
    const galleryHTML = generateGallery(property.images);
    
    // توليد المرافق
    const amenitiesHTML = generateAmenities(property.amenities);
    
    container.innerHTML = `
        <!-- معرض الصور -->
        <div class="property-gallery">
            ${galleryHTML}
        </div>
        
        <!-- المعلومات الرئيسية -->
        <div class="property-info">
            <div class="property-main-info">
                <h1>${property.title}</h1>
                <div class="property-location">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>${property.location}</span>
                </div>
                
                <div class="property-price-large">
                    ${property.price} SAR | <span style="color: #0077B6;">${property.pricePerNight} SAR/night</span>
                </div>
                
                <div class="property-features">
                    <div class="feature-item">
                        <i class="fas fa-door-open"></i>
                        <span>${property.rooms} Rooms</span>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-user-friends"></i>
                        <span>${property.capacity} People</span>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-ruler-combined"></i>
                        <span>350 m²</span>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-bed"></i>
                        <span>${property.rooms - 1} Bedrooms</span>
                    </div>
                </div>
                
                <!-- الوصف -->
                <div class="details-section">
                    <h2>Description</h2>
                    <p class="description-text">${property.description}</p>
                </div>
                
                <!-- المرافق -->
                <div class="details-section">
                    <h2>Amenities</h2>
                    <div class="amenities-grid">
                        ${amenitiesHTML}
                    </div>
                </div>
                
                <!-- التقييم -->
                <div class="details-section">
                    <h2>Ratings & Reviews</h2>
                    <div class="rating-overview">
                        <div class="average-rating">
                            <div class="rating-number">${property.rating}</div>
                            <div class="rating-stars">${stars}</div>
                            <div class="review-count">${property.reviews} reviews</div>
                        </div>
                        <div style="flex: 1;">
                            <p style="color: #555; line-height: 1.6;">"Amazing property with excellent service. The location is perfect and the views are breathtaking!"</p>
                            <p style="color: #7f8c8d; margin-top: 10px;">- Mohammed Al-Saud</p>
                        </div>
                    </div>
                </div>
                
                <!-- الموقع -->
                <div class="details-section">
                    <h2>Location</h2>
                    <div class="location-section">
                        <div class="location-info">
                            <h3>Address</h3>
                            <p class="location-address">
                                <i class="fas fa-map-marker-alt" style="color: #e74c3c;"></i>
                                ${property.address}
                            </p>
                        </div>
                        <div class="map-container">
                            <iframe 
                                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3623.396326532936!2d46.67541531500178!3d24.713755784115!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3e2f03890d489399%3A0xba974d1c98e79fd5!2sRiyadh%2C%20Saudi%20Arabia!5e0!3m2!1sen!2s!4v1620000000000!5m2!1sen!2s" 
                                width="100%" 
                                height="100%" 
                                style="border:0;" 
                                allowfullscreen="" 
                                loading="lazy">
                            </iframe>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- الـ Sidebar (الحجز والتقويم) -->
            <div class="property-sidebar">
                <div class="booking-widget">
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <h3>Select Dates</h3>
                            <div class="calendar-nav">
                                <button onclick="changeMonth(-1)"><i class="fas fa-chevron-left"></i></button>
                                <button onclick="changeMonth(1)"><i class="fas fa-chevron-right"></i></button>
                            </div>
                        </div>
                        <div id="calendar"></div>
                    </div>
                    
                    <div class="booking-summary">
                        <div class="booking-detail">
                            <span>Price per night:</span>
                            <span>${property.pricePerNight} SAR</span>
                        </div>
                        <div class="booking-detail">
                            <span>Nights:</span>
                            <span id="nights-count">0</span>
                        </div>
                        <div class="booking-detail">
                            <span>Service fee:</span>
                            <span id="service-fee">0 SAR</span>
                        </div>
                        <div class="booking-detail total">
                            <span>Total:</span>
                            <span id="total-price">0 SAR</span>
                        </div>
                    </div>
                    
                    <button class="booking-btn" onclick="bookProperty(${property.id})">
                        <i class="fas fa-calendar-check"></i> Book Now
                    </button>
                    <button class="favorite-btn-details ${isFavorite ? 'active' : ''}" 
                            onclick="toggleFavorite(${property.id})" id="favorite-btn">
                        <i class="${isFavorite ? 'fas' : 'far'} fa-heart"></i>
                        ${isFavorite ? 'Remove from Favorites' : 'Add to Favorites'}
                    </button>
                </div>
            </div>
        </div>
    `;
    
    // توليد التقويم بعد تحميل المحتوى
    generateCalendar(property);
}

// دالة توليد معرض الصور
function generateGallery(images) {
    const mainImage = images[0];
    const thumbnails = images.map((img, index) => `
        <div class="thumbnail" onclick="changeMainImage('${img}')">
            <img src="${img}" alt="Property Image ${index + 1}">
        </div>
    `).join('');
    
    return `
        <div class="main-image">
            <img src="${mainImage}" alt="Property Main Image" id="main-image">
        </div>
        <div class="thumbnail-grid">
            ${thumbnails}
        </div>
    `;
}

// دالة توليد المرافق
function generateAmenities(amenities) {
    const amenityIcons = {
        "WiFi": "fa-wifi",
        "Swimming Pool": "fa-swimming-pool",
        "Parking": "fa-car",
        "Gym": "fa-dumbbell",
        "Security": "fa-shield-alt",
        "Air Conditioning": "fa-snowflake"
    };
    
    return amenities.map(amenity => `
        <div class="amenity-item">
            <i class="fas ${amenityIcons[amenity] || 'fa-check'}"></i>
            <span>${amenity}</span>
        </div>
    `).join('');
}

// دالة توليد التقويم
function generateCalendar(property) {
    const calendar = document.getElementById('calendar');
    const monthNames = ["January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"];
    
    const firstDay = new Date(currentYear, currentMonth, 1);
    const lastDay = new Date(currentYear, currentMonth + 1, 0);
    const startingDay = firstDay.getDay();
    
    let calendarHTML = `
        <div class="calendar-grid">
            <div class="calendar-day-header">Sun</div>
            <div class="calendar-day-header">Mon</div>
            <div class="calendar-day-header">Tue</div>
            <div class="calendar-day-header">Wed</div>
            <div class="calendar-day-header">Thu</div>
            <div class="calendar-day-header">Fri</div>
            <div class="calendar-day-header">Sat</div>
    `;
    
    // الأيام الفارغة قبل بداية الشهر
    for (let i = 0; i < startingDay; i++) {
        calendarHTML += `<div class="calendar-day empty"></div>`;
    }
    
    // أيام الشهر
    const today = new Date();
    for (let day = 1; day <= lastDay.getDate(); day++) {
        const dateStr = `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
        const isBooked = property.bookedDates.includes(dateStr);
        const isToday = today.getDate() === day && today.getMonth() === currentMonth && today.getFullYear() === currentYear;
        
        let dayClass = "calendar-day available";
        if (isBooked) dayClass = "calendar-day booked";
        if (isToday) dayClass += " today";
        
        calendarHTML += `<div class="${dayClass}" data-date="${dateStr}">${day}</div>`;
    }
    
    calendarHTML += `</div>`;
    calendar.innerHTML = calendarHTML;
    
    // تحديث العنوان
    document.querySelector('.calendar-header h3').textContent = 
        `${monthNames[currentMonth]} ${currentYear}`;
}

// دوال التحكم في التقويم
function changeMonth(direction) {
    currentMonth += direction;
    if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
    } else if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
    }
    
    const propertyId = parseInt(new URLSearchParams(window.location.search).get('id'));
    const property = properties.find(p => p.id === propertyId);
    generateCalendar(property);
}

// الدوال المساعدة
function changeMainImage(imageUrl) {
    document.getElementById('main-image').src = imageUrl;
}

function bookProperty(propertyId) {
    // توجيه لصفحة الحجز
    window.location.href = `booking.html?id=${propertyId}`;
}

function toggleFavorite(propertyId) {
    let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
    const index = favorites.indexOf(propertyId);
    const button = document.getElementById('favorite-btn');
    
    if (index === -1) {
        favorites.push(propertyId);
        button.innerHTML = '<i class="fas fa-heart"></i> Remove from Favorites';
        button.classList.add('active');
    } else {
        favorites.splice(index, 1);
        button.innerHTML = '<i class="far fa-heart"></i> Add to Favorites';
        button.classList.remove('active');
    }
    
    localStorage.setItem('favorites', JSON.stringify(favorites));
}

function generateStars(rating) {
    let stars = '';
    const fullStars = Math.floor(rating);
    const hasHalfStar = rating % 1 >= 0.5;
    
    for (let i = 0; i < fullStars; i++) {
        stars += '<i class="fas fa-star"></i>';
    }
    
    if (hasHalfStar) {
        stars += '<i class="fas fa-star-half-alt"></i>';
    }
    
    const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
    for (let i = 0; i < emptyStars; i++) {
        stars += '<i class="far fa-star"></i>';
    }
    
    return stars;
}

// تحميل التفاصيل عند فتح الصفحة
document.addEventListener('DOMContentLoaded', loadPropertyDetails);
    </script>
</body>
</html>